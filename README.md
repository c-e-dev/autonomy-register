# Autonomy register
Autonomy register

# Stack
java 17
sqlite
spring boot 2.6
jte
bootstrap

# Описание
Web-приложение для учета отправки, приема документа и учета переписок со структурами по различным темам

https://www.jcabi.com/

https://habr.com/ru/articles/321552/ - spring boot + react

https://github.com/ColorlibHQ/AdminLTE/releases - admin panel

-----------
http://localhost:8080/demo/dist/pages/index.html - демо приложение, с возможными плюшками
http://localhost:8080/index.html - разрабатываемое приложение

https://jte.gg/spring-boot-starter-2/ - шаблонизатор

https://www.sqlitetutorial.net/sqlite-java/jdbc-read-write-blob/ - туториалы по SQLite

https://pandao.github.io/editor.md/en.html - оформление markdown

Сжатие pdf
gs -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -sOutputFile=out.pdf \[614017\,\ г.\ Пермь\,\ ул.\ Куфонина\,\ д.\ 19\,\ кв.\ 9\].pdf

# Для разработки и запуска в прод
Для разработки и поднятия приложения в ИДЕ используем настройки типа Application, с указанием главного класса + System.getenv("SPRING_ENV") != prod

При запуске уже как в проде используем в ИДЕ готовую жарку через тип JAR Application + System.getenv("SPRING_ENV") = prod
Запуск в bash
```bash
/opt/java/jdk-17.0.6-full/bin/java -agentlib:jdwp=transport=dt_socket,address=127.0.0.1:59059,suspend=y,server=n -DSPRING_ENV=prod -Dfile.encoding=UTF-8 -jar /<path to jar>/web-1.0-SNAPSHOT.jar
```
Зачистка данных в таблице
```
DELETE FROM <table>;
UPDATE SQLITE_SEQUENCE SET seq = 0 WHERE name = '<table>';
vacuum;
```

----------------
# Структура БД
## Таблица appeals
Обращения, отправления

Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
id                | INTEGER  PRIMARY KEY("id" AUTOINCREMENT) | Sequence
title                | TEXT                                     | Заголовок, название обращения
internal_number    | TEXT | Внутренний номер документа
register_track_number | TEXT | Почтовый номер отправления 
create_date               | INTEGER  | Дата создания записи. В unixtime
due_date               | INTEGER  | Срок исполнения 
answered               | INTEGER  | Ответили или нет. Возможные значения 0 (false) и 1 (true)

## Таблица appeal_type
Типы загружаемых файлов. Справочник

Колонка               | Тип     | Описание
-----------------------|---------|-----------------
type                | INTEGER | Тип файла, 0 - отправленный, 1 - отвеченный
name                | TEXT    | Название типа

## Таблица themes
Решаемые темы

Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
id                | INTEGER  PRIMARY KEY("id" AUTOINCREMENT) | Sequence
title                | TEXT                                     | Заголовок, название обращения
create_date               | INTEGER  | Дата создания записи. В unixtime
decision_date               | INTEGER  | Дата решения темы
decision_status               | INTEGER  | Статус решения темы
description               | TEXT  | Описание темы

## Таблица themes_link_appeals
Связанные обращения (отправления) с темами

Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
theme_id               | INTEGER  | ID темы из таблицы themes.id
appeal_id               | INTEGER  | ID отправления из таблицы appeals.id

## Таблица files
Файлы

Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
id                | INTEGER  PRIMARY KEY("id" AUTOINCREMENT) | Sequence
name               | TEXT                                     | Название файла
content               | BLOB                                     | Содержимое файла
extension               | TEXT                                     | Расширение файла
size               | INTEGER                                  | Размер файла в байтах
create_date               | INTEGER                                  | Время добавления файла
content_type               | TEXT                                     | Тип контента


## Таблица files_appeal
Связь файлов с отправлениями

Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
id                | INTEGER  PRIMARY KEY("id" AUTOINCREMENT) | Sequence
appeal_id               | INTEGER                                     | Идентификатор отправления из таблицы appeals.id
file_id               | INTEGER                                  | Идентификатор файла из таблицы files.id
appeal_type_id               | INTEGER                                  | Тип загруженного файла (отправленный, отвеченный)

## Таблица settings
Настройки приложения

Колонка               | Тип     | Описание
-----------------------|---------|-----------------
name                | TEXT    | Название ключа
value               | TEXT | Значение ключа

## Таблица addresses
Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
id                | INTEGER  PRIMARY KEY("id" AUTOINCREMENT) | Sequence
recipient                | TEXT | Получатель (поле кому)
address                | TEXT | Адрес получателя (поле куда)
actually                | INTEGER | Актуален адрес? Значения Нет (0), да (1). По умолчанию 1
Чтобы не было повторных записей recipient и address должны строго быть одинаковыми.

## Таблица appeal_address
Связь обращений с адресами получателей

Колонка               | Тип                                      | Описание
-----------------------|------------------------------------------|-----------------
id                | INTEGER  PRIMARY KEY("id" AUTOINCREMENT) | Sequence
appeal_id                | INTEGER | Идентификатор обращения из таблицы appeals
address_id                | INTEGER | Идентификатор адрес из таблицы addresses

# Описание разделов
## Главная
В данном месте можно себя поприветствовать каким-либо образом, 
так же закрепить нужные для себя документы, литературу, в общем ввиде похоже на заметки
## Документы
Тут находится вся суть вашей работы
### Темы
Темы это то, какой вопрос глобально для себя хотите решить, то есть одним запросом обращением куда-либо
свой вопрос обычно не решается, конечно если у вас нет супер силы управления людьми ;) Примером может быть
, что вы хотите перевести землю из одной категории в другую, в этом случае будет не одна переписка и скорее
всего в приличное количество инстанций с обратными ответами-вопросами, либо уже с благодарностями.
### Обращения
Это как раз то самое, которое показывает куда вы волеизъявились, отправили какой-либо документ, ценную бумагу. В общем и целом
список обращений, в котором можно тоже будет покопаться и эти как раз обращения должны входить в раздел "Темы".
А так же это является пакетом документов отправляемые куда-либо.
### Обеспеченный интерес (право требования)
Тут находятся ваши право требования, или как еще называют обеспеченный интерес обесченной стороны (secured party)
Могут иметь потенциальный связки с Темой, а так уже абсолютные, которые уже начали пользоваться

# Запрос доработок и Донаты
## Донаты
При желании помочь автору данного приложения можно перечислить любую сумму на https://www.tbank.ru/rm/bezrukikh.andrey3/Mwtnx84860/
либо по QR-коду

## Запрос доработок
Правила и условия:
1. Касается добавления нового функционала
2. Вами прорабатывает техническое задание на доработку(чем подробнее, тем лучше)
3. Техническое задание отправляется на andreiiko2@rambler.ru с темой письма - Доработка Autonomy Register
4. Стоимость доработки от 1000 рублей
5. Денежные средства перечисляются на такой-то счет, с указанием в комментарии перевода вашего email

В случае